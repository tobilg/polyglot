{
  "dialect": "athena",
  "identity": [
    {
      "sql": "SELECT '\\d+'",
      "expected": null
    },
    {
      "sql": "SELECT 'foo''bar'",
      "expected": null
    },
    {
      "sql": "CREATE TABLE IF NOT EXISTS t (name STRING) LOCATION 's3://bucket/tmp/mytable/' TBLPROPERTIES ('table_type'='iceberg', 'FORMAT'='parquet')",
      "expected": null
    },
    {
      "sql": "UNLOAD (SELECT name1, address1, comment1, key1 FROM table1) TO 's3://amzn-s3-demo-bucket/ partitioned/' WITH (format = 'TEXTFILE', partitioned_by = ARRAY['key1'])",
      "expected": null
    },
    {
      "sql": "USING EXTERNAL FUNCTION some_function(input VARBINARY)\n            RETURNS VARCHAR\n                LAMBDA 'some-name'\n            SELECT\n            some_function(1)",
      "expected": null
    },
    {
      "sql": "/* leading comment */CREATE SCHEMA foo",
      "expected": "/* leading comment */ CREATE SCHEMA `foo`",
      "identify": true
    },
    {
      "sql": "/* leading comment */SELECT * FROM foo",
      "expected": "/* leading comment */ SELECT * FROM \"foo\"",
      "identify": true
    },
    {
      "sql": "CREATE EXTERNAL TABLE foo (id INT) COMMENT 'test comment'",
      "expected": null
    },
    {
      "sql": "CREATE EXTERNAL TABLE george.t (id INT COMMENT 'foo \\\\ bar') LOCATION 's3://my-bucket/'",
      "expected": null
    },
    {
      "sql": "CREATE EXTERNAL TABLE my_table (id BIGINT COMMENT 'this is the row\\'s id') LOCATION 's3://my-s3-bucket'",
      "expected": null
    },
    {
      "sql": "CREATE EXTERNAL TABLE foo (id INT, val STRING) CLUSTERED BY (id, val) INTO 10 BUCKETS",
      "expected": null
    },
    {
      "sql": "CREATE EXTERNAL TABLE foo (id INT, val STRING) STORED AS PARQUET LOCATION 's3://foo' TBLPROPERTIES ('has_encryped_data'='true', 'classification'='test')",
      "expected": null
    },
    {
      "sql": "CREATE EXTERNAL TABLE IF NOT EXISTS foo (a INT, b STRING) ROW FORMAT SERDE 'org.openx.data.jsonserde.JsonSerDe' WITH SERDEPROPERTIES ('case.insensitive'='FALSE') LOCATION 's3://table/path'",
      "expected": null
    },
    {
      "sql": "CREATE EXTERNAL TABLE x (y INT) ROW FORMAT SERDE 'serde' ROW FORMAT DELIMITED FIELDS TERMINATED BY '1' WITH SERDEPROPERTIES ('input.regex'='')",
      "expected": null
    },
    {
      "sql": "CREATE EXTERNAL TABLE `my_table` (`a7` ARRAY<DATE>) ROW FORMAT SERDE 'a' STORED AS INPUTFORMAT 'b' OUTPUTFORMAT 'c' LOCATION 'd' TBLPROPERTIES ('e'='f')",
      "expected": null
    },
    {
      "sql": "CREATE TABLE iceberg_table (`id` BIGINT, `data` STRING, category STRING) PARTITIONED BY (category, BUCKET(16, id)) LOCATION 's3://amzn-s3-demo-bucket/your-folder/' TBLPROPERTIES ('table_type'='ICEBERG', 'write_compression'='snappy')",
      "expected": null
    },
    {
      "sql": "CREATE OR REPLACE TABLE iceberg_table (`id` BIGINT, `data` STRING, category STRING) PARTITIONED BY (category, BUCKET(16, id)) LOCATION 's3://amzn-s3-demo-bucket/your-folder/' TBLPROPERTIES ('table_type'='ICEBERG', 'write_compression'='snappy')",
      "expected": null
    },
    {
      "sql": "CREATE TABLE foo WITH (table_type='ICEBERG', location='s3://foo/', format='orc', partitioning=ARRAY['bucket(id, 5)']) AS SELECT * FROM a",
      "expected": null
    },
    {
      "sql": "CREATE TABLE foo WITH (table_type='HIVE', external_location='s3://foo/', format='parquet', partitioned_by=ARRAY['ds']) AS SELECT * FROM a",
      "expected": null
    },
    {
      "sql": "CREATE TABLE foo AS WITH foo AS (SELECT a, b FROM bar) SELECT * FROM foo",
      "expected": null
    },
    {
      "sql": "ALTER TABLE `foo`.`bar` ADD COLUMN `end_ts` BIGINT",
      "expected": "ALTER TABLE `foo`.`bar` ADD COLUMNS (`end_ts` BIGINT)"
    },
    {
      "sql": "ALTER TABLE `foo` DROP COLUMN `id`",
      "expected": null
    },
    {
      "sql": "CREATE SCHEMA `foo`",
      "expected": null
    },
    {
      "sql": "CREATE SCHEMA foo",
      "expected": null
    },
    {
      "sql": "CREATE EXTERNAL TABLE `foo` (`id` INT) LOCATION 's3://foo/'",
      "expected": null
    },
    {
      "sql": "CREATE EXTERNAL TABLE foo (id INT) LOCATION 's3://foo/'",
      "expected": null
    },
    {
      "sql": "CREATE EXTERNAL TABLE foo (id INT) LOCATION 's3://foo/'",
      "expected": "CREATE EXTERNAL TABLE `foo` (`id` INT) LOCATION 's3://foo/'",
      "identify": true
    },
    {
      "sql": "CREATE TABLE foo AS SELECT * FROM a",
      "expected": null
    },
    {
      "sql": "CREATE TABLE \"foo\" AS SELECT * FROM \"a\"",
      "expected": null
    },
    {
      "sql": "DROP VIEW IF EXISTS \"foo\".\"bar\"",
      "expected": null
    },
    {
      "sql": "CREATE VIEW \"foo\" AS SELECT \"id\" FROM \"tbl\"",
      "expected": null
    },
    {
      "sql": "CREATE VIEW foo AS SELECT id FROM tbl",
      "expected": "CREATE VIEW \"foo\" AS SELECT \"id\" FROM \"tbl\"",
      "identify": true
    },
    {
      "sql": "DROP TABLE `foo`",
      "expected": null
    },
    {
      "sql": "DROP TABLE foo",
      "expected": null
    },
    {
      "sql": "DROP TABLE foo",
      "expected": "DROP TABLE `foo`",
      "identify": true
    },
    {
      "sql": "CREATE VIEW \"foo\" AS SELECT \"id\" FROM \"tbl\"",
      "expected": null
    },
    {
      "sql": "CREATE VIEW foo AS SELECT id FROM tbl",
      "expected": null
    },
    {
      "sql": "CREATE VIEW foo AS SELECT id FROM tbl",
      "expected": "CREATE VIEW \"foo\" AS SELECT \"id\" FROM \"tbl\"",
      "identify": true
    },
    {
      "sql": "CREATE SCHEMA \"foo\"",
      "expected": "CREATE SCHEMA `foo`"
    },
    {
      "sql": "DROP TABLE \"foo\"",
      "expected": "DROP TABLE `foo`"
    },
    {
      "sql": "DESCRIBE foo.bar",
      "expected": "DESCRIBE `foo`.`bar`",
      "identify": true
    },
    {
      "sql": "CREATE TABLE \"foo\" AS WITH \"foo\" AS (SELECT \"a\", \"b\" FROM \"bar\") SELECT * FROM \"foo\"",
      "expected": null
    },
    {
      "sql": "SELECT a AS foo FROM tbl",
      "expected": null
    },
    {
      "sql": "SELECT \"a\" AS \"foo\" FROM \"tbl\"",
      "expected": null
    },
    {
      "sql": "INSERT INTO foo (id) VALUES (1)",
      "expected": null
    },
    {
      "sql": "INSERT INTO \"foo\" (\"id\") VALUES (1)",
      "expected": null
    },
    {
      "sql": "UPDATE foo SET id = 3 WHERE id = 7",
      "expected": null
    },
    {
      "sql": "UPDATE \"foo\" SET \"id\" = 3 WHERE \"id\" = 7",
      "expected": null
    },
    {
      "sql": "DELETE FROM foo WHERE id > 10",
      "expected": null
    },
    {
      "sql": "DELETE FROM \"foo\" WHERE \"id\" > 10",
      "expected": null
    },
    {
      "sql": "WITH foo AS (SELECT a, b FROM bar) SELECT * FROM foo",
      "expected": null
    },
    {
      "sql": "WITH foo AS (SELECT a, b FROM bar) SELECT * FROM foo",
      "expected": "WITH \"foo\" AS (SELECT \"a\", \"b\" FROM \"bar\") SELECT * FROM \"foo\"",
      "identify": true
    }
  ],
  "transpilation": [
    {
      "sql": "SELECT CAST(ds AS VARCHAR) AS ds FROM (VALUES ('2022-01-01')) AS t(ds)",
      "read": {},
      "write": {
        "hive": "SELECT CAST(ds AS STRING) AS ds FROM (VALUES ('2022-01-01')) AS t(ds)",
        "trino": "SELECT CAST(ds AS VARCHAR) AS ds FROM (VALUES ('2022-01-01')) AS t(ds)",
        "athena": "SELECT CAST(ds AS VARCHAR) AS ds FROM (VALUES ('2022-01-01')) AS t(ds)"
      }
    }
  ]
}