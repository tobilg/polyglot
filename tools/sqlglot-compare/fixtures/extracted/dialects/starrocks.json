{
  "dialect": "starrocks",
  "identity": [
    {
      "sql": "SELECT ARRAY_JOIN([1, 3, 5, NULL], '_', 'NULL')",
      "expected": null
    },
    {
      "sql": "SELECT ARRAY_JOIN([1, 3, 5, NULL], '_')",
      "expected": null
    },
    {
      "sql": "ALTER TABLE a SWAP WITH b",
      "expected": null
    },
    {
      "sql": "SELECT ARRAY_AGG(a) FROM x",
      "expected": null
    },
    {
      "sql": "SELECT ST_POINT(10, 20)",
      "expected": null
    },
    {
      "sql": "SELECT ST_DISTANCE_SPHERE(10.1, 20.2, 30.3, 40.4)",
      "expected": null
    },
    {
      "sql": "CURRENT_VERSION()",
      "expected": null
    },
    {
      "sql": "INSERT OVERWRITE my_table SELECT * FROM other_table",
      "expected": null
    },
    {
      "sql": "CREATE TABLE t (c INT) COMMENT 'c'",
      "expected": null
    },
    {
      "sql": "CREATE TABLE foo (col0 DECIMAL(9, 1), col1 DECIMAL32(9, 1), col2 DECIMAL64(18, 10), col3 DECIMAL128(38, 10)) DISTRIBUTED BY HASH (col1) BUCKETS 1",
      "expected": null
    },
    {
      "sql": "CREATE TABLE foo (col1 LARGEINT) DISTRIBUTED BY HASH (col1) BUCKETS 1",
      "expected": null
    },
    {
      "sql": "CREATE VIEW foo (foo_col1) SECURITY NONE AS SELECT bar_col1 FROM bar",
      "expected": null
    },
    {
      "sql": "SELECT CAST(`a`.`b` AS INT) FROM foo",
      "expected": null
    },
    {
      "sql": "SELECT APPROX_COUNT_DISTINCT(a) FROM x",
      "expected": null
    },
    {
      "sql": "SELECT [1, 2, 3]",
      "expected": null
    },
    {
      "sql": "SELECT CAST(PARSE_JSON(fieldvalue) -> '00000000-0000-0000-0000-00000000' AS VARCHAR) AS `code` FROM (SELECT '{\"00000000-0000-0000-0000-00000000\":\"code01\"}') AS t(fieldvalue)",
      "expected": null
    },
    {
      "sql": "SELECT text FROM example_table",
      "expected": "SELECT `text` FROM example_table"
    },
    {
      "sql": "TIMESTAMP('2022-01-01')",
      "expected": null
    },
    {
      "sql": "SELECT DATE_DIFF('SECOND', '2010-11-30 23:59:59', '2010-11-30 20:58:59')",
      "expected": null
    },
    {
      "sql": "SELECT DATE_DIFF('MINUTE', '2010-11-30 23:59:59', '2010-11-30 20:58:59')",
      "expected": null
    },
    {
      "sql": "SELECT student, score, t.unnest FROM tests CROSS JOIN LATERAL UNNEST(scores) AS t",
      "expected": "SELECT student, score, t.unnest FROM tests CROSS JOIN LATERAL UNNEST(scores) AS t(unnest)"
    },
    {
      "sql": "ANALYZE TABLE TBL(c1, c2) PROPERTIES ('prop1'=val1)",
      "expected": null
    },
    {
      "sql": "ANALYZE FULL TABLE TBL(c1, c2) PROPERTIES ('prop1'=val1)",
      "expected": null
    },
    {
      "sql": "ANALYZE SAMPLE TABLE TBL(c1, c2) PROPERTIES ('prop1'=val1)",
      "expected": null
    },
    {
      "sql": "ANALYZE TABLE TBL(c1, c2) WITH SYNC MODE PROPERTIES ('prop1'=val1)",
      "expected": null
    },
    {
      "sql": "ANALYZE TABLE TBL(c1, c2) WITH ASYNC MODE PROPERTIES ('prop1'=val1)",
      "expected": null
    },
    {
      "sql": "ANALYZE TABLE TBL UPDATE HISTOGRAM ON c1, c2 PROPERTIES ('prop1'=val1)",
      "expected": null
    },
    {
      "sql": "ANALYZE TABLE TBL UPDATE HISTOGRAM ON c1, c2 WITH 5 BUCKETS PROPERTIES ('prop1'=val1)",
      "expected": null
    },
    {
      "sql": "ANALYZE TABLE TBL UPDATE HISTOGRAM ON c1, c2 WITH SYNC MODE WITH 5 BUCKETS PROPERTIES ('prop1'=val1)",
      "expected": null
    },
    {
      "sql": "ANALYZE TABLE TBL UPDATE HISTOGRAM ON c1, c2 WITH ASYNC MODE WITH 5 BUCKETS PROPERTIES ('prop1'=val1)",
      "expected": null
    },
    {
      "sql": "SELECT a BETWEEN 1 AND 5 FROM t",
      "expected": null
    },
    {
      "sql": "DELETE FROM t WHERE a BETWEEN b AND c",
      "expected": "DELETE FROM t WHERE a >= b AND a <= c"
    },
    {
      "sql": "DELETE FROM t WHERE a BETWEEN 1 AND 10 AND b BETWEEN 20 AND 30 OR c BETWEEN 'x' AND 'z'",
      "expected": "DELETE FROM t WHERE a >= 1 AND a <= 10 AND b >= 20 AND b <= 30 OR c >= 'x' AND c <= 'z'"
    },
    {
      "sql": "ARRAY_FLATTEN(arr)",
      "expected": null
    },
    {
      "sql": "arr[1]",
      "expected": null
    }
  ],
  "transpilation": [
    {
      "sql": "SELECT * FROM t WHERE cond",
      "read": {
        "starrocks": "SELECT * FROM t WHERE cond"
      },
      "write": {}
    },
    {
      "sql": "CREATE TABLE foo (col1 BIGINT, col2 BIGINT) ROLLUP (r1(col1, col2), r2(col1))",
      "read": {},
      "write": {
        "starrocks": "CREATE TABLE foo (col1 BIGINT, col2 BIGINT) ROLLUP (r1(col1, col2), r2(col1))",
        "spark": "CREATE TABLE foo (col1 BIGINT, col2 BIGINT)",
        "duckdb": "CREATE TABLE foo (col1 BIGINT, col2 BIGINT)",
        "postgres": "CREATE TABLE foo (col1 BIGINT, col2 BIGINT)"
      }
    },
    {
      "sql": "SELECT REGEXP(abc, '%foo%')",
      "read": {
        "mysql": "SELECT REGEXP_LIKE(abc, '%foo%')",
        "starrocks": "SELECT REGEXP(abc, '%foo%')"
      },
      "write": {
        "mysql": "SELECT REGEXP_LIKE(abc, '%foo%')"
      }
    },
    {
      "sql": "SELECT student, score, unnest FROM tests CROSS JOIN LATERAL UNNEST(scores)",
      "read": {},
      "write": {
        "spark": "SELECT student, score, unnest FROM tests LATERAL VIEW EXPLODE(scores) unnest AS unnest",
        "starrocks": "SELECT student, score, unnest FROM tests CROSS JOIN LATERAL UNNEST(scores) AS unnest(unnest)"
      }
    },
    {
      "sql": "SELECT * FROM UNNEST(array['John','Jane','Jim','Jamie'], array[24,25,26,27]) AS t(name, age)",
      "read": {},
      "write": {
        "postgres": "SELECT * FROM UNNEST(ARRAY['John', 'Jane', 'Jim', 'Jamie'], ARRAY[24, 25, 26, 27]) AS t(name, age)",
        "spark": "SELECT * FROM INLINE(ARRAYS_ZIP(ARRAY('John', 'Jane', 'Jim', 'Jamie'), ARRAY(24, 25, 26, 27))) AS t(name, age)",
        "starrocks": "SELECT * FROM UNNEST(['John', 'Jane', 'Jim', 'Jamie'], [24, 25, 26, 27]) AS t(name, age)"
      }
    },
    {
      "sql": "SELECT id, t.type, t.scores FROM example_table, unnest(split(type, \";\"), scores) AS t(type,scores)",
      "read": {},
      "write": {
        "postgres": "SELECT id, t.type, t.scores FROM example_table, UNNEST(SPLIT(type, ';'), scores) AS t(type, scores)",
        "spark": "SELECT id, t.type, t.scores FROM example_table LATERAL VIEW INLINE(ARRAYS_ZIP(SPLIT(type, CONCAT('\\\\Q', ';', '\\\\E')), scores)) t AS type, scores",
        "databricks": "SELECT id, t.type, t.scores FROM example_table LATERAL VIEW INLINE(ARRAYS_ZIP(SPLIT(type, CONCAT('\\\\Q', ';', '\\\\E')), scores)) t AS type, scores",
        "starrocks": "SELECT id, t.type, t.scores FROM example_table, UNNEST(SPLIT(type, ';'), scores) AS t(type, scores)"
      }
    },
    {
      "sql": "SELECT id, t.type, t.scores FROM example_table_2 CROSS JOIN LATERAL unnest(split(type, \";\"), scores) AS t(type,scores)",
      "read": {},
      "write": {
        "spark": "SELECT id, t.type, t.scores FROM example_table_2 LATERAL VIEW INLINE(ARRAYS_ZIP(SPLIT(type, CONCAT('\\\\Q', ';', '\\\\E')), scores)) t AS type, scores",
        "starrocks": "SELECT id, t.type, t.scores FROM example_table_2 CROSS JOIN LATERAL UNNEST(SPLIT(type, ';'), scores) AS t(type, scores)"
      }
    },
    {
      "sql": "SELECT * FROM t WHERE a BETWEEN 1 AND 5",
      "read": {},
      "write": {
        "starrocks": "SELECT * FROM t WHERE a BETWEEN 1 AND 5",
        "mysql": "SELECT * FROM t WHERE a BETWEEN 1 AND 5"
      }
    }
  ]
}